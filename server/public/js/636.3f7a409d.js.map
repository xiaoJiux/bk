{"version":3,"file":"js/636.3f7a409d.js","mappings":"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","sources":["webpack://client/./src/views/Message.vue?3af3","webpack://client/src/views/Message.vue","webpack://client/./src/views/Message.vue?2cc5","webpack://client/./src/views/Message.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"Message\"}},[_c('div',{staticClass:\"top\"},[_c('img',{attrs:{\"src\":require(\"../../src/assets/img/message/card.png\"),\"alt\":\"\"}}),_c('div',{staticClass:\"right\"},[_c('h2',[_vm._v(\"留言板\")]),_c('p',[_vm._v(\"请文明发言哦！不然小心禁言、拉黑套餐>.<\")]),_c('el-input',{attrs:{\"rows\":10,\"type\":\"textarea\",\"placeholder\":\"请输入内容\",\"maxlength\":\"120\",\"show-word-limit\":\"\"},model:{value:(_vm.textarea),callback:function ($$v) {_vm.textarea=$$v},expression:\"textarea\"}}),_c('div',{staticClass:\"btn\"},[_c('i',{staticClass:\"iconfont icon-biaoqing\",on:{\"click\":function($event){$event.stopPropagation();return _vm.handleToggleEmoji.apply(null, arguments)}}}),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":_vm.handleMsgSubmit}},[_vm._v(\"发表\")]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showEmoji),expression:\"showEmoji\"}],staticClass:\"emoji\",on:{\"click\":function($event){$event.stopPropagation();}}},[_c('ul',_vm._l((_vm.emoji),function(item){return _c('li',{on:{\"click\":function($event){return _vm.handleEmojiClick(item)}}},[_vm._v(\" \"+_vm._s(item)+\" \")])}),0)]),_c('div',{staticClass:\"clear\"})],1)],1)]),_c('article',{staticClass:\"content\"},[_c('ul',_vm._l((_vm.msgData),function(item){return _c('li',[_c('div',{staticClass:\"parent\"},[_c('div',{staticClass:\"left\"},[_c('img',{attrs:{\"src\":_vm.urlBase+item.user.tx,\"alt\":\"\"}})]),_c('div',{staticClass:\"right\"},[_c('div',{staticClass:\"name-time\"},[_c('span',[_vm._v(_vm._s(item.user.username))]),_c('span',[_vm._v(_vm._s(_vm._f(\"fmtTime\")(item.time)))])]),_c('div',{staticClass:\"message\"},[_vm._v(\" \"+_vm._s(item.msg)+\" \")]),_c('div',{staticClass:\"like-reply\"},[_c('i',{staticClass:\"like iconfont icon-xinaixin\",class:{\n                  isLike: item.likes.indexOf(_vm.userInfo._id) !== -1\n                },on:{\"click\":function($event){return _vm.handleLikesClick(item, item)}}}),_c('span',[_vm._v(_vm._s(item.likes.length))]),_c('i',{staticClass:\"reply iconfont icon-huifu\",on:{\"click\":function($event){return _vm.handleReplyClick(item, item)}}})])])]),_vm._l((item.children),function(childItem,childIndex){return _c('div',{staticClass:\"child\"},[_c('div',{staticClass:\"left\"},[_c('img',{attrs:{\"src\":_vm.urlBase+childItem.user.tx,\"alt\":\"\"}})]),_c('div',{staticClass:\"right\"},[_c('div',{staticClass:\"name-time\"},[_c('span',[_vm._v(_vm._s(childItem.user.username))]),_c('span',[_vm._v(_vm._s(_vm._f(\"fmtTime\")(childItem.time)))])]),_c('div',{staticClass:\"message\"},[_c('span',[_vm._v(\"@\"+_vm._s(childItem.reply.username))]),_vm._v(\" \"+_vm._s(childItem.msg)+\" \")]),_c('div',{staticClass:\"like-reply\"},[_c('i',{staticClass:\"like iconfont icon-xinaixin\",class:{\n                  isLike: childItem.likes.indexOf(_vm.userInfo._id) !== -1\n                },on:{\"click\":function($event){return _vm.handleLikesClick(item, childItem, childIndex)}}}),_c('span',[_vm._v(_vm._s(childItem.likes.length))]),_c('i',{staticClass:\"reply iconfont icon-huifu\",on:{\"click\":function($event){return _vm.handleReplyClick(item, childItem)}}})])])])}),_c('div',{staticClass:\"replyInput\",class:{\n            'show': item.isShowReply\n          }},[_c('el-input',{attrs:{\"placeholder\":'@'+item.replyUser.username,\"size\":\"mini\"},model:{value:(item.replyTxt),callback:function ($$v) {_vm.$set(item, \"replyTxt\", $$v)},expression:\"item.replyTxt\"}}),_c('el-button',{staticClass:\"replyBtn\",attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.handleReplyInputClick(item)}}},[_vm._v(\"回复 \")]),_c('div',{staticClass:\"clear\"})],1)],2)}),0)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div id=\"Message\">\r\n    <div class=\"top\">\r\n      <img src=\"../../src/assets/img/message/card.png\" alt=\"\">\r\n      <div class=\"right\">\r\n        <h2>留言板</h2>\r\n        <p>请文明发言哦！不然小心禁言、拉黑套餐>.<</p>\r\n        <el-input :rows=\"10\"\r\n                  type=\"textarea\"\r\n                  placeholder=\"请输入内容\"\r\n                  v-model=\"textarea\"\r\n                  maxlength=\"120\"\r\n                  show-word-limit\r\n        >\r\n        </el-input>\r\n        <div class=\"btn\">\r\n          <i\r\n            class=\"iconfont icon-biaoqing\"\r\n            @click.stop=\"handleToggleEmoji\"\r\n          ></i>\r\n          <el-button type=\"primary\" size=\"mini\"\r\n          @click=\"handleMsgSubmit\"\r\n          >发表</el-button>\r\n          <div\r\n            v-show=\"showEmoji\"\r\n            @click.stop\r\n            class=\"emoji\">\r\n            <ul>\r\n              <li\r\n                v-for=\"item in emoji\"\r\n                @click=\"handleEmojiClick(item)\"\r\n              >\r\n                {{ item }}\r\n              </li>\r\n            </ul>\r\n          </div>\r\n          <div class=\"clear\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <article class=\"content\">\r\n      <ul>\r\n        <li v-for=\"item in msgData\">\r\n          <!--父留言-->\r\n          <div class=\"parent\">\r\n            <!--留言-->\r\n            <div class=\"left\">\r\n              <img :src=\"urlBase+item.user.tx\" alt=\"\">\r\n            </div>\r\n            <div class=\"right\">\r\n              <div class=\"name-time\">\r\n                <span>{{ item.user.username }}</span>\r\n                <span>{{ item.time | fmtTime }}</span>\r\n              </div>\r\n              <div class=\"message\">\r\n                {{ item.msg }}\r\n              </div>\r\n              <div class=\"like-reply\">\r\n                <i\r\n                  class=\"like iconfont icon-xinaixin\"\r\n                  :class=\"{\r\n                    isLike: item.likes.indexOf(userInfo._id) !== -1\r\n                  }\"\r\n                  @click=\"handleLikesClick(item, item)\"\r\n                ></i>\r\n                <span>{{ item.likes.length }}</span>\r\n                <i\r\n                  class=\"reply iconfont icon-huifu\"\r\n                  @click=\"handleReplyClick(item, item)\"\r\n                ></i>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!--子留言-->\r\n          <div class=\"child\" v-for=\"(childItem,childIndex) in item.children\">\r\n            <div class=\"left\">\r\n              <img :src=\"urlBase+childItem.user.tx\" alt=\"\">\r\n            </div>\r\n            <div class=\"right\">\r\n              <div class=\"name-time\">\r\n                <span>{{ childItem.user.username }}</span>\r\n                <span>{{ childItem.time | fmtTime }}</span>\r\n              </div>\r\n              <div class=\"message\">\r\n                <span>@{{ childItem.reply.username }}</span>\r\n                {{ childItem.msg }}\r\n              </div>\r\n              <div class=\"like-reply\">\r\n                <i\r\n                  class=\"like iconfont icon-xinaixin\"\r\n                  :class=\"{\r\n                    isLike: childItem.likes.indexOf(userInfo._id) !== -1\r\n                  }\"\r\n                  @click=\"handleLikesClick(item, childItem, childIndex)\"\r\n                ></i>\r\n                <span>{{ childItem.likes.length }}</span>\r\n                <i\r\n                  class=\"reply iconfont icon-huifu\"\r\n                  @click=\"handleReplyClick(item, childItem)\"\r\n                ></i>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!--回复框-->\r\n          <div\r\n            class=\"replyInput\"\r\n            :class=\"{\r\n              'show': item.isShowReply\r\n            }\"\r\n          >\r\n            <el-input\r\n              v-model=\"item.replyTxt\"\r\n              :placeholder=\"'@'+item.replyUser.username\"\r\n              size=\"mini\"\r\n            ></el-input>\r\n            <el-button\r\n              class=\"replyBtn\"\r\n              type=\"primary\"\r\n              size=\"mini\"\r\n              @click=\"handleReplyInputClick(item)\"\r\n            >回复\r\n            </el-button>\r\n            <div class=\"clear\"></div>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </article>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from \"vuex\";\r\n\r\nexport default {\r\n  name: \"Message\",\r\n  data() {\r\n    return {\r\n      textarea: \"\",\r\n      showEmoji: false,\r\n      showEmail: [],\r\n      emoji: [\r\n        \"😃\", \"😁\", \"😂\", \"😊\", \"🙃\", \"🥰\", \"😘\", \"🤭\", \"🤔\", \"😏\",\r\n        \"😵\", \"😟\", \"🙁\", \"😳\", \"😰\", \"😭\", \"😖\", \"😡\", \"😠\", \"😈\",\r\n        \"🤡\", \"☠️\", \"👻\", \"🙈\", \"🙉\", \"❤️\", \"💖\", \"💢\", \"💣\", \"💤\",\r\n        \"👋\", \"👍\", \"👌\", \"🤞\", \"🤟\", \"🤙\", \"👊\", \"🖕\", \"🤝\", \"🙏\",\r\n        \"🙅\", \"🙅‍♂️\", \"👨‍✈️\", \"👩‍✈️\", \"👷\", \"👷‍♀️\", \"🤦\", \"🤦‍♂️\", \"👴\", \"🧓\",\r\n        \"🐴\", \"🐮\", \"🐖\", \"🐑\", \"🐓\", \"🦚\", \"🐲\", \"🐳\", \"🐟\", \"🐌\",\r\n      ],\r\n      msgData: []\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState(['userInfo'])\r\n  },\r\n  methods: {\r\n    //切换emoji的显示与隐藏\r\n    handleToggleEmoji() {\r\n      this.showEmoji = !this.showEmoji\r\n    },\r\n\r\n    //点击每一个emoji的时候，加入input\r\n    handleEmojiClick(item) {\r\n      this.textarea += item\r\n      this.showEmoji = false\r\n    },\r\n\r\n    //留言提交\r\n\r\n    async handleMsgSubmit() {\r\n\r\n      let msg = this.textarea.trim()\r\n      let userId = this.userInfo._id\r\n      //检测用户是否登录\r\n      if (!userId) {\r\n        return this.$message.error(\"请先登录\")\r\n      }\r\n      //检测留言内容是否为空\r\n      if (!msg) {\r\n        return this.$message.error(\"请先输入留言内容\")\r\n      }\r\n\r\n      //向后端发请求\r\n      let {data} = await this.$axios({\r\n        method: 'post',\r\n        url: \"/msg\",\r\n        data: {msg, userId}\r\n      })\r\n\r\n      if (data.code !== 0) {\r\n        return this.$message.error(data.msg)\r\n      }\r\n\r\n      //留言成功\r\n      this.$message({\r\n        type: \"success\",\r\n        message: \"留言发表成功\",\r\n        duration: 1000,\r\n        onClose() {\r\n          window.location.reload()\r\n        }\r\n      })\r\n\r\n    },\r\n\r\n    //请求留言数据\r\n    async getMsgList() {\r\n      let {data: {data}} = await this.$axios({\r\n        method: 'get'\r\n        , url: \"/msg\"\r\n      })\r\n\r\n      data.filter(item => {\r\n        //用来表示每一条留言的回复输入框的内容\r\n        item.replyTxt = \"\"\r\n        //用来表示回复的是哪个\r\n        item.replyUser = {...item.user}\r\n        //用来表示当前留言的回复框要不要打开\r\n        item.isShowReply = false\r\n      })\r\n\r\n      // console.log(data);\r\n\r\n      this.msgData = data\r\n    },\r\n\r\n    //like点击\r\n    async handleLikesClick(item, thisItem, childIndex) {\r\n      //是否登录\r\n      let userId = this.userInfo._id\r\n      if (!userId){\r\n        return this.$message.error(\"请先登录\")\r\n      }\r\n      //是点赞还是取消赞\r\n      let likes = thisItem.likes\r\n      let index = likes.indexOf(userId)\r\n      if (index !== -1){\r\n        //取消赞\r\n        likes.splice(index,1)\r\n      }else{\r\n        //点赞\r\n        likes.push(userId)\r\n      }\r\n\r\n      //发送到后端\r\n      await this.$axios({\r\n        method: \"post\",\r\n        url: \"/msg/like\",\r\n        data: {\r\n          parentId: item._id,\r\n          childId: thisItem._id,\r\n          likes,\r\n          childIndex\r\n        }\r\n      })\r\n\r\n    },\r\n\r\n    //回复按钮点击\r\n    async handleReplyClick(item, thisItem) {\r\n\r\n      //要收起来的情况\r\n      if (\r\n        thisItem.user._id === item.replyUser._id\r\n        && item.isShowReply\r\n      ) {\r\n        item.isShowReply = false\r\n        return\r\n      }\r\n\r\n      item.replyUser = thisItem.user\r\n      item.isShowReply = true\r\n    },\r\n\r\n    //回复框提交\r\n    async handleReplyInputClick(item) {\r\n\r\n      //回复的内容\r\n      let msg = item.replyTxt.trim()\r\n      //当前登录的用户id -- 回复人id\r\n      let user = this.userInfo._id\r\n      //回复的是谁\r\n      let reply = item.replyUser._id\r\n      if (!msg) {\r\n        return this.$message.error(\"请先输入回复内容\")\r\n      }\r\n      if (!user) {\r\n        return this.$message.error(\"请先登录！\")\r\n      }\r\n\r\n      let msgId = item._id,\r\n        child = {msg, user, reply}\r\n\r\n      let {data} = await this.$axios({\r\n        method: \"post\",\r\n        url: \"/msg/reply\",\r\n        data: {msgId, child}\r\n      })\r\n\r\n      if (data.code !== 0) {\r\n        return this.$message.error(data.code)\r\n      }\r\n\r\n      //回复成功\r\n      this.$message({\r\n        type: \"success\",\r\n        message: \"回复成功\",\r\n        duration: 1000,\r\n        onClose() {\r\n          window.location.reload()\r\n        }\r\n      })\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    document.addEventListener(\"click\", () => {\r\n      this.showEmoji = false\r\n    })\r\n\r\n    this.getMsgList()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n#Message {\r\n\r\n  .top {\r\n    display: flex;\r\n    justify-content: space-between;\r\n\r\n    .right {\r\n      margin-left: 5px;\r\n      padding: 15px 10px 5px;\r\n      background-color: #fff;\r\n      flex: 1;\r\n\r\n      h2 {\r\n        border-left: 5px solid rgb(115, 184, 153);\r\n        padding-left: 15px;\r\n      }\r\n\r\n      p {\r\n        padding: 20px 0 20px 30px;\r\n        color: #aba9a9;\r\n      }\r\n\r\n      .btn {\r\n        position: relative;\r\n        padding-top: 25px;\r\n\r\n        > i {\r\n          float: left;\r\n          font-size: 20px;\r\n          margin-top: 5px;\r\n          cursor: pointer;\r\n        }\r\n\r\n        .el-button {\r\n          float: right;\r\n        }\r\n\r\n        .emoji {\r\n          position: absolute;\r\n          top: 30px;\r\n          background-color: #fff;\r\n          padding: 8px;\r\n          box-shadow: 0 0 3px #aaa;\r\n          user-select: none;\r\n\r\n          &::before {\r\n            content: \"\";\r\n            position: absolute;\r\n            z-index: 3;\r\n            top: -10px;\r\n            left: 5px;\r\n            width: 0;\r\n            height: 0;\r\n            border: 5px solid transparent;\r\n            border-bottom-color: #ccc;\r\n          }\r\n\r\n          ul {\r\n            width: 250px;\r\n            height: 150px;\r\n            border-left: 1px solid #e5e5e5;\r\n            border-bottom: 1px solid #e5e5e5;\r\n\r\n            li {\r\n              box-sizing: border-box;\r\n              float: left;\r\n              width: 25px;\r\n              height: 25px;\r\n              border-right: 1px solid #e5e5e5;\r\n              border-top: 1px solid #e5e5e5;\r\n              font-size: 18px;\r\n              line-height: 25px;\r\n              cursor: pointer;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  article {\r\n    margin-top: 15px;\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    margin-bottom: 15px;\r\n    box-shadow: 0 0 4px #ddd;\r\n    padding: 25px 20px;\r\n    background-color: #fff;\r\n    font-family: \"Quicksand\", \"Microsoft YaHei\", sans-serif;\r\n\r\n    &.content {\r\n      user-select: none;\r\n      ul {\r\n        li {\r\n          padding-bottom: 5px;\r\n          margin-bottom: 10px;\r\n          border-bottom: 1px dashed #ddd;\r\n          font-size: 12px;\r\n          font-family: \"Microsoft YaHei\", \"sans-serif\";\r\n\r\n          div.parent, div.child {\r\n            display: flex;\r\n          }\r\n\r\n          div.child {\r\n            margin-left: 55px;\r\n            margin-top: 3px;\r\n          }\r\n\r\n          div.left {\r\n            overflow: hidden;\r\n            width: 40px;\r\n            height: 40px;\r\n            margin-right: 15px;\r\n            border-radius: 50%;\r\n\r\n            img {\r\n              width: 100%;\r\n              height: 100%;\r\n            }\r\n          }\r\n\r\n          div.right {\r\n            flex: 1;\r\n\r\n            div.name-time {\r\n              font-size: 12px;\r\n              margin-bottom: 3px;\r\n\r\n              span:nth-child(1) {\r\n                color: #73b899;\r\n              }\r\n\r\n              span:nth-child(2) {\r\n                color: #aaa;\r\n                margin-left: 10px;\r\n                font-family: \"Microsoft YaHei\", \"sans-serif\";\r\n              }\r\n            }\r\n\r\n            div.message {\r\n              color: #666;\r\n              letter-spacing: 2px;\r\n              margin-bottom: 3px;\r\n              word-break: break-word;\r\n\r\n              span {\r\n                color: #409eff;\r\n                margin-right: 5px;\r\n              }\r\n            }\r\n\r\n            div.like-reply {\r\n              i {\r\n                cursor: pointer;\r\n                font-size: 14px;\r\n                color: #aaa;\r\n              }\r\n              i.isLike{\r\n                color: #f30606;\r\n              }\r\n\r\n              span {\r\n                display: inline-block;\r\n                width: 43px;\r\n                font-size: 12px;\r\n                color: #aaa;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    .replyInput {\r\n      box-sizing: border-box;\r\n      overflow: hidden;\r\n      width: 100%;\r\n      height: 0;\r\n      padding-left: 55px;\r\n      transition: height .3s;\r\n\r\n      &.show {\r\n        height: 50px;\r\n      }\r\n\r\n      .replyBtn {\r\n        padding: 4px 9px !important;\r\n        float: right;\r\n      }\r\n    }}\r\n}\r\n</style>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Message.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Message.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Message.vue?vue&type=template&id=10c76290&scoped=true&\"\nimport script from \"./Message.vue?vue&type=script&lang=js&\"\nexport * from \"./Message.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Message.vue?vue&type=style&index=0&id=10c76290&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"10c76290\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","model","value","callback","$$v","textarea","expression","on","$event","stopPropagation","handleToggleEmoji","apply","arguments","handleMsgSubmit","directives","name","rawName","_l","item","handleEmojiClick","_s","urlBase","user","tx","username","_f","time","msg","class","isLike","likes","indexOf","userInfo","_id","handleLikesClick","length","handleReplyClick","childItem","childIndex","reply","isShowReply","replyUser","$set","handleReplyInputClick","staticRenderFns","data","showEmoji","showEmail","emoji","msgData","computed","methods","async","trim","userId","$message","error","method","url","code","type","message","duration","onClose","window","location","reload","filter","replyTxt","thisItem","index","splice","push","$axios","parentId","childId","msgId","child","mounted","document","addEventListener","getMsgList","component"],"sourceRoot":""}