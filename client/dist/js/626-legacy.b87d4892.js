"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[626],{3626:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"UserInfo"}},[""===e.userInfo._id?s("article",{staticClass:"notLogin"},[s("h2",[e._v("温馨提示")]),s("p",[e._v("您暂时还未登录,请登录后再尝试!!! "),s("router-link",{attrs:{to:"/"}},[e._v("点击返回首页")])],1)]):s("article",{staticClass:"setting"},[s("el-tabs",{staticStyle:{"min-height":"200px"},attrs:{"tab-position":"left"}},[s("el-tab-pane",{attrs:{label:"账户信息"}},[s("div",{staticClass:"userTx"},[s("span",[e._v("用户头像")]),s("div",{staticClass:"img",style:{backgroundImage:"url("+e.urlBase+e.userInfo.tx+")"}})]),s("el-descriptions",{attrs:{column:1,labelStyle:e.labelStyle,contentStyle:e.labelStyle}},[s("el-descriptions-item",{attrs:{label:"用户名"}},[e._v(e._s(e.userInfo.username))]),s("el-descriptions-item",{attrs:{label:"邮箱"}},[e._v(e._s(void 0===e.userInfo.email?"暂时还未绑定邮箱":e.userInfo.email)+" ")]),s("el-descriptions-item",{attrs:{label:"注册时间"}},[e._v(e._s(e._f("fmtTime")(e.userInfo.regTime)))])],1)],1),s("el-tab-pane",{attrs:{label:"更改头像"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{name:"avatar",action:e.urlBase+"/upload/tx","show-file-list":!1,"with-credentials":!0,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?s("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),s("el-tab-pane",{attrs:{label:"更改用户名"}},[s("el-form",{ref:"nameForm",staticClass:"demo-ruleForm",attrs:{model:e.nameForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[s("p",{staticClass:"username"},[e._v("用户名: "),s("span",[e._v(e._s(e.userInfo.username))])]),s("el-form-item",{attrs:{label:"新用户名",prop:"newName"}},[s("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.nameForm.newName,callback:function(t){e.$set(e.nameForm,"newName",t)},expression:"nameForm.newName"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitName("nameForm")}}},[e._v("提交")])],1)],1)],1),s("el-tab-pane",{attrs:{label:"更改密码"}},[s("el-form",{ref:"passForm",staticClass:"demo-ruleForm",attrs:{model:e.passForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"旧密码",prop:"oldPass"}},[s("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.passForm.oldPass,callback:function(t){e.$set(e.passForm,"oldPass",t)},expression:"passForm.oldPass"}})],1),s("el-form-item",{attrs:{label:"新密码",prop:"newPass"}},[s("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.passForm.newPass,callback:function(t){e.$set(e.passForm,"newPass",t)},expression:"passForm.newPass"}})],1),s("el-form-item",{attrs:{label:"确认密码",prop:"newPass2"}},[s("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.passForm.newPass2,callback:function(t){e.$set(e.passForm,"newPass2",t)},expression:"passForm.newPass2"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitPass("passForm")}}},[e._v("提交")]),s("el-button",{on:{click:function(t){return e.resetPass("ruleForm")}}},[e._v("重置")])],1)],1)],1)],1)],1)])},r=[],n=s(6198),o=s(3019),l=(s(8975),s(4916),s(7601),s(1703),s(1539),s(8783),s(3948),s(285),s(1637),s(4665)),i={name:"UserInfo",computed:(0,o.Z)({},(0,l.rn)(["userInfo"])),data:function(){var e=this;return{urlBase:"",labelStyle:{"font-size":"18px","margin-bottom":"10px"},passForm:{oldPass:"",newPass:"",newPass2:""},nameForm:{newName:""},imageUrl:"",rules:{username:[{validator:function(e,t,s){/^[\w\u4e00-\u9fa5]{2,8}$/.test(t)?s():s(new Error("用户名不满足规则"))},required:!0,trigger:"blur"}],newPass:[{validator:function(e,t,s){/^[\w\[\]\/\\\-!@#$%^&*()+=|,.<>?:;"'{}]{6,18}$/.test(t)?s():s(new Error("密码不满足规则"))},required:!0,trigger:"blur"}],newPass2:[{validator:function(t,s,a){s===e.passForm.newPass?a():a("两次输入密码不一致")},required:!0,trigger:"blur"}],oldPass:[{validator:function(e,t,s){/^[\w\[\]\/\\\-!@#$%^&*()+=|,.<>?:;"'{}]{6,18}$/.test(t)?s():s(new Error("密码不满足规则"))},required:!0,trigger:"blur"}]}}},methods:(0,o.Z)((0,o.Z)({},(0,l.OI)(["logout"])),{},{submitPass:function(e){var t=this;this.$refs[e].validate(function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(s){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!s){e.next=7;break}return e.next=3,t.$axios({method:"post",url:"/update/pass",data:{oldpassword:t.passForm.oldPass,newpassword:t.passForm.newPass,_id:t.userInfo._id}});case 3:a=e.sent,r=a.data,console.log(r),t.logout();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},submitName:function(e){var t=this;this.$refs[e].validate(function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(s){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!s){e.next=10;break}return e.next=3,t.$axios({method:"post",url:"/update/name",data:{newName:t.nameForm.newName}});case 3:if(a=e.sent,r=a.data,0===r.code){e.next=7;break}return e.abrupt("return",t.$message.error(r.msg));case 7:t.$message({type:"success",duration:1e3,message:"更新成功",onClose:function(){window.location.reload()}}),e.next=11;break;case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handleAvatarSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw),this.$message({type:"success",message:"上传成功",duration:1e3,onClose:function(){window.location.reload()}})},beforeAvatarUpload:function(e){var t=/^image\/(gif|jpeg|png)$/.test(e.type),s=e.size/1024/1024<2;return t||this.$message.error("上传头像必须是jpg/png/gif图片"),s||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&s},resetPass:function(e){this.$refs[e].resetFields()}})},u=i,m=s(1001),c=(0,m.Z)(u,a,r,!1,null,"0425af0d",null),p=c.exports}}]);
//# sourceMappingURL=626-legacy.b87d4892.js.map